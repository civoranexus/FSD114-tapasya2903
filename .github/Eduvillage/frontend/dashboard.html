<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Dashboard | EduVillage</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="dashboard-wrapper">

  <!-- Sidebar -->
  <aside class="dashboard-sidebar">
    <h3 style="color: white;">EduVillage</h3>
    <p>Student Dashboard</p>

    <a href="home.html">Home</a>
    <a href="courses.html">Browse Courses</a>
    <a href="dashboard.html" class="active">Dashboard</a>
    <a href="profile.html">My Profile</a>
    <a href="contact.html">Contact</a>
    <a href="#" id="logoutBtn">Logout</a>
  </aside>

 
  <main class="dashboard-main">


    <div class="dashboard-topbar">
      <h2 id="welcomeText">Welcome ðŸ‘‹</h2>
    </div>

    <section class="dashboard-courses">
      <h2>Our Courses</h2>
      <div id="courseGrid" class="course-grid"></div>
    </section>

   
    <section class="dashboard-courses">
      <h2>My Learning</h2>
      <div class="course-grid" id="myLearningGrid"></div>
    </section>

  </main>

</div>

<script>
 
  const user = JSON.parse(localStorage.getItem("user"));

  if (!user) {
    window.location.href = "login.html";
  } else {
    document.getElementById("welcomeText").textContent =
      `Welcome, ${user.name} ðŸ‘‹`;
  }


  document.getElementById("logoutBtn").addEventListener("click", () => {
    localStorage.removeItem("user");
    window.location.href = "login.html";
  });


  async function loadCourses() {
    try {
      const response = await fetch("http://localhost:5000/api/courses");
      const courses = await response.json();

      const grid = document.getElementById("courseGrid");
      grid.innerHTML = "";

      if (courses.length === 0) {
        grid.innerHTML = "<p>No courses available</p>";
        return;
      }

      courses.forEach(course => {
        const card = document.createElement("div");
        card.className = "course-card";

        card.innerHTML = `
          <h3>${course.title}</h3>
          <p>${course.category}</p>
          <p>${course.description}</p>
          <button>View Course</button>
        `;

        grid.appendChild(card);
      });
    } catch (error) {
      console.error("Failed to load courses", error);
    }
  }

  loadCourses();

  const enrolledCourses = [
  { id: "html", title: "HTML Basics" },
  { id: "css", title: "CSS Fundamentals" },
  { id: "js", title: "JavaScript Basics" }
];

function loadMyLearning() {
  const grid = document.getElementById("myLearningGrid");
  grid.innerHTML = "";

  enrolledCourses.forEach(course => {
    let progress = localStorage.getItem(course.id) || 0;

    const card = document.createElement("div");
    card.className = "course-card";

    card.innerHTML = `
      <h3>${course.title}</h3>
      <p>Progress: <span id="${course.id}-progress">${progress}</span>%</p>
      <progress value="${progress}" max="100"></progress>
      <button onclick="updateProgress('${course.id}')">
        ${progress >= 100 ? "View Certificate" : "Continue"}
      </button>
    `;

    grid.appendChild(card);
  });
}

function updateProgress(courseId) {
  let progress = parseInt(localStorage.getItem(courseId)) || 0;

  if (progress < 100) {
    progress += 10;
    if (progress > 100) progress = 100;
    localStorage.setItem(courseId, progress);
  }

  loadMyLearning();
}

</script>

</body>
</html>
